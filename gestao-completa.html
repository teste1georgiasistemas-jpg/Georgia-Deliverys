<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gest√£o Completa - Georgia Deliverys</title>
    <link rel="stylesheet" href="styles/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="scripts/supabase-config.js" defer></script>
    <style>
        /* Estilos b√°sicos do admin */
        :root {
            --roxo-admin: #7C3AED;
            --roxo-claro: #A78BFA;
            --magenta: #EC4899;
            --fundo: #F9FAFB;
            --sidebar: #1F2937;
        }
        
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: var(--fundo);
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar */
        .admin-sidebar {
            width: 260px;
            background: linear-gradient(180deg, var(--sidebar), #111827);
            color: white;
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
        }
        
        .admin-logo {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .admin-logo h1 {
            font-size: 24px;
            margin: 15px 0 5px;
            color: var(--roxo-claro);
        }
        
        .admin-logo p {
            color: #9CA3AF;
            font-size: 14px;
        }
        
        .admin-menu {
            flex: 1;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            color: #D1D5DB;
            text-decoration: none;
            border-radius: 10px;
            margin-bottom: 8px;
            transition: all 0.3s;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 16px;
        }
        
        .menu-item:hover, .menu-item.active {
            background: rgba(139, 92, 246, 0.2);
            color: white;
        }
        
        .menu-item i {
            width: 20px;
            text-align: center;
        }
        
        /* Conte√∫do principal */
        .admin-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .page-title h2 {
            margin: 0;
            font-size: 28px;
            color: var(--sidebar);
        }
        
        .page-title p {
            margin: 5px 0 0;
            color: #6B7280;
        }
        
        /* Cards */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card h3 {
            color: #6B7280;
            font-size: 14px;
            margin: 0 0 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .card .valor {
            font-size: 32px;
            font-weight: bold;
            color: var(--roxo-admin);
            margin: 0;
        }
        
        /* Tabelas */
        .admin-table {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        
        .table-header {
            padding: 20px;
            border-bottom: 1px solid #E5E7EB;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: #F9FAFB;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 1px solid #E5E7EB;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #E5E7EB;
        }
        
        tr:hover {
            background: #F9FAFB;
        }
        
        /* Bot√µes admin */
        .btn-admin {
            background: linear-gradient(135deg, var(--roxo-admin), var(--magenta));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-admin:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(124, 58, 237, 0.3);
        }
        
        .btn-secondary {
            background: #E5E7EB;
            color: #374151;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10B981, #059669);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }
        
        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #E5E7EB;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--roxo-admin);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }
        
        /* Login admin */
        .login-admin {
            max-width: 400px;
            margin: 100px auto;
            padding: 40px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .login-icon {
            font-size: 60px;
            color: var(--roxo-admin);
            margin-bottom: 20px;
        }
        
        /* Se√ß√µes */
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Status badges */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-pendente { background: #FEF3C7; color: #92400E; }
        .status-aceito { background: #DBEAFE; color: #1E40AF; }
        .status-producao { background: #E0E7FF; color: #3730A3; }
        .status-pronto { background: #D1FAE5; color: #065F46; }
        .status-entrega { background: #FCE7F3; color: #BE185D; }
        .status-entregue { background: #D1FAE5; color: #065F46; }
        .status-cancelado { background: #FEE2E2; color: #991B1B; }
        
        /* Atualiza√ß√£o autom√°tica */
        .badge-ao-vivo {
            background: linear-gradient(135deg, #EC4899, #8B5CF6);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            animation: pulsar 2s infinite;
            margin-left: 10px;
        }
        
        @keyframes pulsar {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        /* Responsivo */
        @media (max-width: 1024px) {
            body {
                flex-direction: column;
            }
            
            .admin-sidebar {
                width: 100%;
                flex-direction: row;
                padding: 20px;
                align-items: center;
            }
            
            .admin-logo {
                margin-bottom: 0;
                margin-right: 30px;
            }
            
            .admin-menu {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .menu-item {
                margin-bottom: 0;
                padding: 10px 15px;
            }
        }
        
        @media (max-width: 768px) {
            .admin-content {
                padding: 20px;
            }
            
            .cards-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-header {
                flex-direction: column;
                gap: 20px;
                align-items: flex-start;
            }
            
            .table-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div id="login-screen" class="login-admin">
        <div class="login-icon">
            <i class="fas fa-lock"></i>
        </div>
        <h2>Gest√£o Completa</h2>
        <p style="color: #6B7280; margin-bottom: 30px;">
            Acesso restrito aos administradores
        </p>
        
        <div class="form-group">
            <input type="text" id="admin-email" class="form-control" placeholder="Email do administrador" value="admin@georgia.com">
        </div>
        
        <div class="form-group">
            <input type="password" id="admin-senha" class="form-control" placeholder="Senha" value="GeorgiaAdmin2024!">
        </div>
        
        <button class="btn-admin" onclick="loginAdmin()" style="width: 100%;">
            <i class="fas fa-sign-in-alt"></i> Acessar Sistema
        </button>
        
        <p style="margin-top: 20px; font-size: 14px; color: #9CA3AF;">
            Dados para teste: admin@georgia.com / GeorgiaAdmin2024!
        </p>
    </div>
    
    <!-- Sistema Admin (aparece depois do login) -->
    <div id="admin-system" style="display: none; width: 100%;">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="admin-logo">
                <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--roxo-admin), var(--magenta)); 
                           border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                    <i class="fas fa-crown" style="font-size: 28px;"></i>
                </div>
                <h1>Georgia Deliverys</h1>
                <p>Gest√£o Completa 
                    <span class="badge-ao-vivo">AO VIVO</span>
                </p>
            </div>
            
            <nav class="admin-menu">
                <button class="menu-item active" onclick="mostrarSecao('dashboard')">
                    <i class="fas fa-chart-line"></i> Dashboard
                </button>
                <button class="menu-item" onclick="mostrarSecao('produtos')">
                    <i class="fas fa-hamburger"></i> Produtos
                </button>
                <button class="menu-item" onclick="mostrarSecao('pedidos')">
                    <i class="fas fa-receipt"></i> Pedidos
                </button>
                <button class="menu-item" onclick="mostrarSecao('cupons')">
                    <i class="fas fa-tag"></i> Cupons
                </button>
                <button class="menu-item" onclick="mostrarSecao('funcionarios')">
                    <i class="fas fa-users"></i> Funcion√°rios
                </button>
                <button class="menu-item" onclick="mostrarSecao('config')">
                    <i class="fas fa-cog"></i> Configura√ß√µes
                </button>
                <button class="menu-item" onclick="mostrarSecao('financeiro')">
                    <i class="fas fa-chart-pie"></i> Financeiro
                </button>
            </nav>
            
            <div style="margin-top: auto; padding: 20px 0; border-top: 1px solid rgba(255,255,255,0.1);">
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                    <div style="width: 12px; height: 12px; background: #10B981; border-radius: 50%; animation: pulsar 2s infinite;"></div>
                    <span style="font-size: 14px; color: #9CA3AF;">Sistema atualizando</span>
                </div>
                <button class="menu-item" onclick="sairAdmin()">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </aside>
        
        <!-- Conte√∫do Principal -->
        <main class="admin-content">
            <!-- Header -->
            <header class="admin-header">
                <div class="page-title">
                    <h2 id="titulo-pagina">Dashboard</h2>
                    <p id="subtitulo-pagina">
                        <span id="status-conexao">üîÑ Conectando ao banco...</span>
                        <span id="ultima-atualizacao" style="margin-left: 15px; font-size: 12px;"></span>
                    </p>
                </div>
                
                <div style="display: flex; gap: 15px; align-items: center;">
                    <div style="background: #F3F4F6; padding: 10px 20px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 14px; color: #6B7280;">Atualiza a cada</div>
                        <div style="font-weight: bold; color: var(--roxo-admin);">30 seg</div>
                    </div>
                    <button class="btn-admin" onclick="forcarAtualizacao()">
                        <i class="fas fa-sync-alt"></i> Atualizar Agora
                    </button>
                </div>
            </header>
            
            <!-- Dashboard -->
            <section id="dashboard" class="section active">
                <div class="cards-grid">
                    <div class="card">
                        <h3>Faturamento Hoje</h3>
                        <p class="valor">R$ <span id="faturamento-hoje">0,00</span></p>
                        <p style="color: #10B981; margin: 5px 0 0; font-size: 14px;">
                            <i class="fas fa-arrow-up"></i> 
                            <span id="variacao-hoje">0%</span> vs ontem
                        </p>
                    </div>
                    
                    <div class="card">
                        <h3>Pedidos Hoje</h3>
                        <p class="valor"><span id="pedidos-hoje">0</span></p>
                        <p style="color: #10B981; margin: 5px 0 0; font-size: 14px;">
                            <i class="fas fa-shopping-bag"></i> 
                            <span id="pedidos-ativos">0</span> ativos
                        </p>
                    </div>
                    
                    <div class="card">
                        <h3>Clientes Novos</h3>
                        <p class="valor"><span id="clientes-novos">0</span></p>
                        <p style="color: #10B981; margin: 5px 0 0; font-size: 14px;">
                            <i class="fas fa-users"></i> 
                            Hoje
                        </p>
                    </div>
                    
                    <div class="card">
                        <h3>Ticket M√©dio</h3>
                        <p class="valor">R$ <span id="ticket-medio">0,00</span></p>
                        <p style="color: #6B7280; margin: 5px 0 0; font-size: 14px;">
                            <i class="fas fa-chart-line"></i> Valor m√©dio
                        </p>
                    </div>
                </div>
                
                <!-- Gr√°fico Simples -->
                <div class="card" style="margin-top: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0;">Faturamento dos √öltimos 7 Dias</h3>
                        <span class="badge-ao-vivo">ATUALIZANDO</span>
                    </div>
                    <div id="grafico-faturamento" style="height: 300px; display: flex; align-items: flex-end; gap: 15px; margin-top: 20px; padding: 20px; background: #F9FAFB; border-radius: 10px;">
                        <!-- Gr√°fico ser√° gerado aqui -->
                        <div style="flex: 1; text-align: center;">
                            <div class="barra-grafico" style="background: linear-gradient(to top, var(--roxo-admin), var(--magenta)); height: 50px; border-radius: 5px 5px 0 0;"></div>
                            <p style="margin: 10px 0 0; font-weight: 600;">Seg</p>
                            <p style="color: #6B7280; font-size: 14px;">R$ 0</p>
                        </div>
                        <!-- Mais barras ser√£o adicionadas via JavaScript -->
                    </div>
                </div>
                
                <!-- Pedidos Recentes -->
                <div class="admin-table" style="margin-top: 30px;">
                    <div class="table-header">
                        <h3 style="margin: 0;">Pedidos Recentes</h3>
                        <button class="btn-admin btn-secondary" onclick="mostrarSecao('pedidos')">
                            Ver Todos
                        </button>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Pedido</th>
                                <th>Cliente</th>
                                <th>Valor</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-pedidos-recentes">
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 40px; color: #9CA3AF;">
                                    <i class="fas fa-sync fa-spin" style="font-size: 24px; margin-bottom: 10px; display: block;"></i>
                                    Carregando pedidos...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Produtos -->
            <section id="produtos" class="section">
                <div class="table-header">
                    <div>
                        <h3 style="margin: 0;">Produtos Cadastrados</h3>
                        <p style="margin: 5px 0 0; color: #6B7280; font-size: 14px;">
                            <span id="contador-produtos">0</span> produtos | 
                            <span id="produtos-ativos">0</span> ativos
                        </p>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="busca-produto" class="form-control" placeholder="Buscar produto..." style="width: 200px;">
                        <button class="btn-admin" onclick="abrirModalProduto()">
                            <i class="fas fa-plus"></i> Novo Produto
                        </button>
                    </div>
                </div>
                
                <div class="admin-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Produto</th>
                                <th>Categoria</th>
                                <th>Pre√ßo</th>
                                <th>Status</th>
                                <th>Vendas</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-produtos">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 40px; color: #9CA3AF;">
                                    Carregando produtos do banco de dados...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Pedidos -->
            <section id="pedidos" class="section">
                <div class="table-header">
                    <div>
                        <h3 style="margin: 0;">Todos os Pedidos</h3>
                        <p style="margin: 5px 0 0; color: #6B7280; font-size: 14px;">
                            <span id="total-pedidos">0</span> pedidos encontrados
                        </p>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <select id="filtro-status" class="form-control" style="width: 150px;" onchange="filtrarPedidos()">
                            <option value="todos">Todos status</option>
                            <option value="pendente">Pendentes</option>
                            <option value="aceito">Aceitos</option>
                            <option value="preparando">Em produ√ß√£o</option>
                            <option value="pronto">Prontos</option>
                            <option value="em_entrega">Em entrega</option>
                            <option value="entregue">Entregues</option>
                            <option value="cancelado">Cancelados</option>
                        </select>
                        <input type="date" id="filtro-data" class="form-control" style="width: 150px;" onchange="filtrarPedidos()">
                        <button class="btn-admin btn-secondary" onclick="resetarFiltros()">
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>
                </div>
                
                <div class="admin-table">
                    <div style="max-height: 600px; overflow-y: auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Pedido</th>
                                    <th>Cliente</th>
                                    <th>Data/Hora</th>
                                    <th>Valor</th>
                                    <th>Pagamento</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="tabela-todos-pedidos">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 40px; color: #9CA3AF;">
                                        Carregando hist√≥rico de pedidos...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Configura√ß√µes -->
            <section id="config" class="section">
                <div class="card">
                    <h3>Configura√ß√µes da Loja</h3>
                    
                    <div class="form-group">
                        <label>Nome da Loja</label>
                        <input type="text" class="form-control" id="nome-loja" value="Georgia Deliverys">
                    </div>
                    
                    <div class="form-group">
                        <label>WhatsApp para Pedidos</label>
                        <input type="text" class="form-control" id="whatsapp-loja" value="(11) 99999-9999">
                    </div>
                    
                    <div class="form-group">
                        <label>Hor√°rio de Funcionamento</label>
                        <input type="text" class="form-control" id="horario-loja" value="18:00 - 23:00 (Todos os dias)">
                    </div>
                    
                    <div class="form-group">
                        <label>Taxa de Entrega por KM</label>
                        <div style="display: grid; gap: 10px; margin-top: 10px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="min-width: 80px;">At√© 3 km:</span>
                                <input type="text" class="form-control" value="R$ 5,00">
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="min-width: 80px;">3-6 km:</span>
                                <input type="text" class="form-control" value="R$ 8,00">
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="min-width: 80px;">6-10 km:</span>
                                <input type="text" class="form-control" value="R$ 12,00">
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="min-width: 80px;">Acima 10 km:</span>
                                <input type="text" class="form-control" value="R$ 15,00">
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn-admin btn-success" style="width: 100%; margin-top: 20px;" onclick="salvarConfiguracoes()">
                        <i class="fas fa-save"></i> Salvar Todas as Configura√ß√µes
                    </button>
                </div>
                
                <!-- Configura√ß√µes do Sistema -->
                <div class="card" style="margin-top: 30px;">
                    <h3>Configura√ß√µes do Sistema</h3>
                    
                    <div class="form-group">
                        <label>Intervalo de Atualiza√ß√£o Autom√°tica</label>
                        <select class="form-control" id="intervalo-atualizacao" onchange="mudarIntervaloAtualizacao()">
                            <option value="10000">10 segundos</option>
                            <option value="30000" selected>30 segundos</option>
                            <option value="60000">1 minuto</option>
                            <option value="120000">2 minutos</option>
                            <option value="300000">5 minutos</option>
                        </select>
                        <p style="color: #6B7280; font-size: 12px; margin-top: 5px;">
                            Tempo entre atualiza√ß√µes autom√°ticas dos dados
                        </p>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="notificacoes-som" checked>
                            Sons de notifica√ß√£o
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="modo-escuro">
                            Modo escuro (em breve)
                        </label>
                    </div>
                </div>
            </section>
            
            <!-- Financeiro -->
            <section id="financeiro" class="section">
                <div class="cards-grid">
                    <div class="card">
                        <h3>Faturamento Mensal</h3>
                        <p class="valor">R$ <span id="faturamento-mensal">0,00</span></p>
                        <p style="color: #10B981; margin: 5px 0 0; font-size: 14px;">
                            <i class="fas fa-calendar"></i> Este m√™s
                        </p>
                    </div>
                    <div class="card">
                        <h3>Pedidos M√™s</h3>
                        <p class="valor"><span id="pedidos-mes">0</span></p>
                        <p style="color: #3B82F6; margin: 5px 0 0; font-size: 14px;">
                            <i class="fas fa-shopping-bag"></i> Total
                        </p>
                    </div>
                    <div class="card">
                        <h3>Ticket M√©dio</h3>
                        <p class="valor">R$ <span id="ticket-medio-geral">0,00</span></p>
                        <p style="color: #8B5CF6; margin: 5px 0 0; font-size: 14px;">
                            <i class="fas fa-chart-line"></i> M√©dia
                        </p>
                    </div>
                </div>
                
                <div class="card" style="margin-top: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0;">Faturamento - √öltimos 7 Dias</h3>
                        <div>
                            <button class="btn-admin btn-secondary" style="padding: 8px 15px;" onclick="exportarDados()">
                                <i class="fas fa-download"></i> Exportar
                            </button>
                        </div>
                    </div>
                    <div id="grafico-financeiro" style="height: 300px; margin-top: 20px; padding: 20px; background: #F9FAFB; border-radius: 10px; display: flex; align-items: flex-end; justify-content: space-around;">
                        <!-- Gr√°fico ser√° gerado aqui -->
                        <div style="text-align: center; flex: 1;">
                            <div style="background: linear-gradient(to top, var(--roxo-admin), var(--magenta)); height: 50px; border-radius: 5px 5px 0 0; margin: 0 10px;"></div>
                            <p style="margin: 10px 0 0; font-weight: 600;">Carregando...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Relat√≥rio Detalhado -->
                <div class="admin-table" style="margin-top: 30px;">
                    <div class="table-header">
                        <h3 style="margin: 0;">Relat√≥rio Di√°rio</h3>
                        <div style="display: flex; gap: 10px;">
                            <input type="date" id="data-relatorio" class="form-control" style="width: 150px;" value="<?php echo date('Y-m-d'); ?>">
                            <button class="btn-admin" onclick="gerarRelatorio()">
                                <i class="fas fa-file-alt"></i> Gerar
                            </button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Hora</th>
                                <th>Pedidos</th>
                                <th>Faturamento</th>
                                <th>Ticket M√©dio</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-relatorio">
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 40px; color: #9CA3AF;">
                                    Selecione uma data para gerar relat√≥rio
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Modal para novo produto -->
    <div id="modal-produto" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
          background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center; padding: 20px;">
        <div style="background: white; border-radius: 20px; padding: 30px; width: 100%; max-width: 500px;">
            <h2 style="margin: 0 0 20px;">Novo Produto</h2>
            
            <div class="form-group">
                <label>Nome do Produto *</label>
                <input type="text" class="form-control" id="produto-nome" placeholder="Ex: X-Burger Especial">
            </div>
            
            <div class="form-group">
                <label>Descri√ß√£o</label>
                <textarea class="form-control" id="produto-descricao" rows="3" placeholder="Descreva o produto..."></textarea>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div class="form-group">
                    <label>Pre√ßo (R$) *</label>
                    <input type="number" class="form-control" id="produto-preco" step="0.01" value="29.90">
                </div>
                
                <div class="form-group">
                    <label>Categoria *</label>
                    <select class="form-control" id="produto-categoria">
                        <option value="">Selecione</option>
                        <option value="Principais">Principais</option>
                        <option value="Combos">Combos</option>
                        <option value="Acompanhamentos">Acompanhamentos</option>
                        <option value="Bebidas">Bebidas</option>
                        <option value="Sobremesas">Sobremesas</option>
                    </select>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 30px;">
                <button class="btn-admin" style="flex: 1;" onclick="salvarProduto()">
                    <i class="fas fa-check"></i> Salvar
                </button>
                <button class="btn-admin btn-secondary" style="flex: 1;" onclick="fecharModalProduto()">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Sistema de Auto-Atualiza√ß√£o para Gest√£o Completa -->
    <script>
    // Sistema de atualiza√ß√£o autom√°tica
    let intervalosAtualizacao = {
        dashboard: null,
        produtos: null,
        pedidos: null,
        financeiro: null
    };
    
    let intervaloGlobal = 30000; // 30 segundos padr√£o
    
    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üè¢ Gest√£o Completa - Sistema carregado');
        atualizarDataHora();
        
        // Verificar conex√£o com Supabase
        verificarConexao();
    });
    
    // ==================== FUN√á√ïES PRINCIPAIS ====================
    
    // Login do administrador
    function loginAdmin() {
        const email = document.getElementById('admin-email').value;
        const senha = document.getElementById('admin-senha').value;
        
        if (email === 'admin@georgia.com' && senha === 'GeorgiaAdmin2024!') {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('admin-system').style.display = 'flex';
            
            // Iniciar sistema
            iniciarSistema();
            
            mostrarNotificacao('Bem-vindo ao sistema de gest√£o completa!', 'success');
        } else {
            alert('Credenciais incorretas. Use: admin@georgia.com / GeorgiaAdmin2024!');
        }
    }
    
    // Sair do sistema
    function sairAdmin() {
        if (confirm('Tem certeza que deseja sair do sistema de gest√£o?')) {
            // Parar todas as atualiza√ß√µes
            pararTodasAtualizacoes();
            
            document.getElementById('admin-system').style.display = 'none';
            document.getElementById('login-screen').style.display = 'block';
            
            mostrarNotificacao('Sess√£o encerrada', 'info');
        }
    }
    
    // Iniciar sistema ap√≥s login
    function iniciarSistema() {
        // Atualizar data/hora
        setInterval(atualizarDataHora, 60000);
        
        // Iniciar dashboard
        setTimeout(() => {
            iniciarAtualizacaoDashboard();
            atualizarStatusConexao();
        }, 1000);
    }
    
    // ==================== ATUALIZA√á√ÉO AUTOM√ÅTICA ====================
    
    // Iniciar atualiza√ß√£o do dashboard
    function iniciarAtualizacaoDashboard() {
        // Limpar intervalo anterior
        if (intervalosAtualizacao.dashboard) {
            clearInterval(intervalosAtualizacao.dashboard);
        }
        
        // Atualizar imediatamente
        atualizarDashboard();
        
        // Configurar intervalo
        intervalosAtualizacao.dashboard = setInterval(atualizarDashboard, intervaloGlobal);
        
        console.log(`üìä Dashboard: Atualizando a cada ${intervaloGlobal/1000} segundos`);
    }
    
    // Atualizar dashboard
    async function atualizarDashboard() {
        try {
            const client = window.supabaseConfig?.getClient();
            
            if (!client) {
                // Modo demo
                atualizarDashboardDemo();
                return;
            }
            
            // Buscar dados do dia
            const hoje = new Date().toISOString().split('T')[0];
            
            const { data: pedidosHoje, error } = await client
                .from('orders')
                .select('*')
                .gte('created_at', hoje);
            
            if (error) throw error;
            
            // Calcular estat√≠sticas
            const faturamento = pedidosHoje.reduce((total, pedido) => 
                total + (parseFloat(pedido.total) || 0), 0);
            
            const pedidosCount = pedidosHoje.length;
            const pedidosAtivos = pedidosHoje.filter(p => 
                ['pendente', 'aceito', 'preparando', 'pronto', 'em_entrega'].includes(p.status)
            ).length;
            
            const ticketMedio = pedidosCount > 0 ? (faturamento / pedidosCount) : 0;
            
            // Atualizar cards
            document.getElementById('faturamento-hoje').textContent = faturamento.toFixed(2);
            document.getElementById('pedidos-hoje').textContent = pedidosCount;
            document.getElementById('pedidos-ativos').textContent = pedidosAtivos;
            document.getElementById('ticket-medio').textContent = ticketMedio.toFixed(2);
            
            // Atualizar tabela de pedidos recentes
            atualizarTabelaPedidosRecentes(pedidosHoje.slice(0, 5));
            
            // Atualizar gr√°fico
            atualizarGraficoFaturamento(pedidosHoje);
            
            // Atualizar √∫ltimo update
            document.getElementById('ultima-atualizacao').textContent = 
                `√öltima atualiza√ß√£o: ${new Date().toLocaleTimeString('pt-BR', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    second: '2-digit'
                })}`;
            
        } catch (err) {
            console.error('Erro ao atualizar dashboard:', err);
            atualizarDashboardDemo();
        }
    }
    
    // Dashboard modo demo
    function atualizarDashboardDemo() {
        // Dados fict√≠cios para demonstra√ß√£o
        const faturamento = 872.50 + (Math.random() * 100 - 50);
        const pedidos = 18 + Math.floor(Math.random() * 5 - 2);
        const ativos = 5 + Math.floor(Math.random() * 3);
        const ticket = faturamento / (pedidos || 1);
        
        document.getElementById('faturamento-hoje').textContent = faturamento.toFixed(2);
        document.getElementById('pedidos-hoje').textContent = pedidos;
        document.getElementById('pedidos-ativos').textContent = ativos;
        document.getElementById('ticket-medio').textContent = ticket.toFixed(2);
        document.getElementById('variacao-hoje').textContent = `${(Math.random() * 20 - 10).toFixed(1)}%`;
        
        // Simular pedidos recentes
        const pedidosDemo = [
            { id: 2350, cliente_nome: 'Carlos Silva', total: 67.90, status: 'entregue' },
            { id: 2349, cliente_nome: 'Ana Santos', total: 89.50, status: 'em_entrega' },
            { id: 2348, cliente_nome: 'Jo√£o Oliveira', total: 45.90, status: 'preparando' }
        ];
        
        atualizarTabelaPedidosRecentes(pedidosDemo);
        
        document.getElementById('ultima-atualizacao').textContent = 
            `Modo demo - ${new Date().toLocaleTimeString('pt-BR')}`;
    }
    
    // Atualizar tabela de pedidos recentes
    function atualizarTabelaPedidosRecentes(pedidos) {
        const tabela = document.getElementById('tabela-pedidos-recentes');
        if (!tabela) return;
        
        tabela.innerHTML = '';
        
        if (pedidos.length === 0) {
            tabela.innerHTML = `
                <tr>
                    <td colspan="5" style="text-align: center; padding: 30px; color: #9CA3AF;">
                        <i class="fas fa-inbox" style="font-size: 24px; margin-bottom: 10px; display: block;"></i>
                        Nenhum pedido hoje
                    </td>
                </tr>
            `;
            return;
        }
        
        pedidos.forEach(pedido => {
            const numero = pedido.id?.toString().slice(-4) || '0000';
            const statusCor = {
                'pendente': '#F59E0B',
                'aceito': '#3B82F6',
                'preparando': '#8B5CF6',
                'pronto': '#10B981',
                'em_entrega': '#EC4899',
                'entregue': '#6B7280',
                'cancelado': '#EF4444'
            }[pedido.status] || '#6B7280';
            
            const row = `
                <tr>
                    <td><strong>#${numero}</strong></td>
                    <td>${pedido.cliente_nome || 'Cliente'}</td>
                    <td>R$ ${parseFloat(pedido.total || 0).toFixed(2)}</td>
                    <td>
                        <span style="background: ${statusCor}20; color: ${statusCor}; 
                               padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600;">
                            ${pedido.status?.toUpperCase() || 'PENDENTE'}
                        </span>
                    </td>
                    <td>
                        <button class="btn-admin" style="padding: 5px 10px; font-size: 12px;"
                                onclick="verDetalhesPedido(${pedido.id || 0})">
                            Detalhes
                        </button>
                    </td>
                </tr>
            `;
            tabela.innerHTML += row;
        });
    }
    
    // Atualizar gr√°fico de faturamento
    function atualizarGraficoFaturamento(pedidos) {
        const grafico = document.getElementById('grafico-faturamento');
        if (!grafico) return;
        
        // Agrupar por hora
        const horas = Array(12).fill(0).map((_, i) => i + 12); // 12-23h
        const faturamentoPorHora = Array(12).fill(0);
        
        pedidos.forEach(pedido => {
            const hora = new Date(pedido.created_at || new Date()).getHours();
            if (hora >= 12 && hora <= 23) {
                faturamentoPorHora[hora - 12] += parseFloat(pedido.total) || 0;
            }
        });
        
        // Gerar barras
        grafico.innerHTML = '';
        const maxFaturamento = Math.max(...faturamentoPorHora, 1);
        
        horas.forEach((hora, index) => {
            const valor = faturamentoPorHora[index];
            const altura = (valor / maxFaturamento) * 200;
            
            const barra = `
                <div style="flex: 1; text-align: center;">
                    <div class="barra-grafico" style="
                        background: linear-gradient(to top, var(--roxo-admin), var(--magenta)); 
                        height: ${Math.max(altura, 10)}px; 
                        border-radius: 5px 5px 0 0;
                        transition: height 0.5s ease;
                    "></div>
                    <p style="margin: 10px 0 0; font-weight: 600;">${hora}h</p>
                    <p style="color: #6B7280; font-size: 12px;">R$ ${valor.toFixed(0)}</p>
                </div>
            `;
            grafico.innerHTML += barra;
        });
    }
    
    // ==================== SE√á√ÉO PRODUTOS ====================
    
    function mostrarSecao(secao) {
        // Parar todas as atualiza√ß√µes
        pararTodasAtualizacoes();
        
        // Esconder todas as se√ß√µes
        document.querySelectorAll('.section').forEach(el => {
            el.classList.remove('active');
        });
        
        // Remover ativo de todos os menus
        document.querySelectorAll('.menu-item').forEach(el => {
            el.classList.remove('active');
        });
        
        // Mostrar se√ß√£o selecionada
        document.getElementById(secao).classList.add('active');
        
        // Ativar menu correspondente
        const menuItem = document.querySelector(`.menu-item[onclick="mostrarSecao('${secao}')"]`);
        if (menuItem) menuItem.classList.add('active');
        
        // Atualizar t√≠tulo
        const titulos = {
            'dashboard': 'Dashboard',
            'produtos': 'Gerenciar Produtos',
            'pedidos': 'Pedidos',
            'cupons': 'Cupons de Desconto',
            'funcionarios': 'Funcion√°rios',
            'config': 'Configura√ß√µes da Loja',
            'financeiro': 'Relat√≥rios Financeiros'
        };
        
        const subtitulos = {
            'dashboard': 'Vis√£o geral do seu neg√≥cio',
            'produtos': 'Gerencie seu card√°pio',
            'pedidos': 'Hist√≥rico de todos os pedidos',
            'cupons': 'Crie e gerencie cupons',
            'funcionarios': 'Controle de acesso',
            'config': 'Personalize sua loja',
            'financeiro': 'An√°lises detalhadas'
        };
        
        document.getElementById('titulo-pagina').textContent = titulos[secao] || secao;
        document.getElementById('subtitulo-pagina').innerHTML = 
            `<span id="status-conexao">‚úÖ Conectado</span> ‚Ä¢ ${subtitulos[secao] || ''}`;
        
        // Iniciar atualiza√ß√£o espec√≠fica da se√ß√£o
        setTimeout(() => {
            switch(secao) {
                case 'dashboard':
                    iniciarAtualizacaoDashboard();
                    break;
                    
                case 'produtos':
                    carregarProdutosDoBanco();
                    intervalosAtualizacao.produtos = setInterval(carregarProdutosDoBanco, intervaloGlobal);
                    break;
                    
                case 'pedidos':
                    carregarPedidosDoBanco();
                    intervalosAtualizacao.pedidos = setInterval(carregarPedidosDoBanco, intervaloGlobal);
                    break;
                    
                case 'financeiro':
                    atualizarDadosFinanceiros();
                    intervalosAtualizacao.financeiro = setInterval(atualizarDadosFinanceiros, intervaloGlobal);
                    break;
            }
        }, 500);
    }
    
    // Carregar produtos do banco
    async function carregarProdutosDoBanco() {
        try {
            const client = window.supabaseConfig?.getClient();
            const tabela = document.getElementById('tabela-produtos');
            
            if (!client || !tabela) {
                carregarProdutosDemo();
                return;
            }
            
            const { data: produtos, error } = await client
                .from('products')
                .select('*')
                .order('nome');
            
            if (error) throw error;
            
            // Atualizar contadores
            document.getElementById('contador-produtos').textContent = produtos.length;
            document.getElementById('produtos-ativos').textContent = 
                produtos.filter(p => p.ativo).length;
            
            // Atualizar tabela
            tabela.innerHTML = '';
            
            if (produtos.length === 0) {
                tabela.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: #9CA3AF;">
                            Nenhum produto cadastrado
                        </td>
                    </tr>
                `;
                return;
            }
            
            produtos.forEach(prod => {
                const vendas = Math.floor(Math.random() * 100) + 50; // Simulado
                
                const row = `
                    <tr>
                        <td style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 40px; height: 40px; background: #E5E7EB; border-radius: 8px;"></div>
                            <div>
                                <strong>${prod.nome}</strong><br>
                                <small style="color: #6B7280;">${prod.descricao || 'Sem descri√ß√£o'}</small>
                            </div>
                        </td>
                        <td>
                            <span style="background: #E0E7FF; color: #3730A3; padding: 4px 8px; border-radius: 4px; font-size: 12px;">
                                ${prod.categoria || 'Geral'}
                            </span>
                        </td>
                        <td><strong>R$ ${parseFloat(prod.preco).toFixed(2)}</strong></td>
                        <td>
                            <span style="color: ${prod.ativo ? '#10B981' : '#EF4444'};">
                                ‚óè ${prod.ativo ? 'Ativo' : 'Inativo'}
                            </span>
                        </td>
                        <td>${vendas}</td>
                        <td>
                            <button class="btn-admin btn-secondary" style="padding: 5px 10px; font-size: 12px;" 
                                    onclick="editarProduto(${prod.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-admin ${prod.ativo ? 'btn-danger' : 'btn-success'}" 
                                    style="padding: 5px 10px; font-size: 12px; margin-left: 5px;"
                                    onclick="alternarStatusProduto(${prod.id}, ${prod.ativo})">
                                ${prod.ativo ? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play"></i>'}
                            </button>
                        </td>
                    </tr>
                `;
                tabela.innerHTML += row;
            });
            
        } catch (err) {
            console.error('Erro ao carregar produtos:', err);
            carregarProdutosDemo();
        }
    }
    
    function carregarProdutosDemo() {
        const produtosDemo = [
            { id: 1, nome: 'X-Burger Georgia', descricao: 'Hamb√∫rguer artesanal', categoria: 'Principais', preco: 29.90, ativo: true },
            { id: 2, nome: 'Combo Fam√≠lia', descricao: '4 hamb√∫rgueres + acompanhamentos', categoria: 'Combos', preco: 99.90, ativo: true },
            { id: 3, nome: 'Batata Frita Grande', descricao: 'Por√ß√£o com cheddar', categoria: 'Acompanhamentos', preco: 19.90, ativo: true },
            { id: 4, nome: 'Coca-Cola 2L', descricao: 'Refrigerante', categoria: 'Bebidas', preco: 12.90, ativo: true },
            { id: 5, nome: 'Brownie com Sorvete', descricao: 'Sobremesa especial', categoria: 'Sobremesas', preco: 24.90, ativo: false }
        ];
        
        const tabela = document.getElementById('tabela-produtos');
        if (!tabela) return;
        
        tabela.innerHTML = '';
        
        produtosDemo.forEach(prod => {
            const vendas = Math.floor(Math.random() * 100) + 50;
            
            const row = `
                <tr>
                    <td style="display: flex; align-items: center; gap: 10px;">
                        <div style="width: 40px; height: 40px; background: #E5E7EB; border-radius: 8px;"></div>
                        <div>
                            <strong>${prod.nome}</strong><br>
                            <small style="color: #6B7280;">${prod.descricao}</small>
                        </div>
                    </td>
                    <td>${prod.categoria}</td>
                    <td><strong>R$ ${prod.preco.toFixed(2)}</strong></td>
                    <td>
                        <span style="color: ${prod.ativo ? '#10B981' : '#EF4444'};">
                            ‚óè ${prod.ativo ? 'Ativo' : 'Inativo'}
                        </span>
                    </td>
                    <td>${vendas}</td>
                    <td>
                        <button class="btn-admin btn-secondary" style="padding: 5px 10px; font-size: 12px;" 
                                onclick="editarProduto(${prod.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-admin ${prod.ativo ? 'btn-danger' : 'btn-success'}" 
                                style="padding: 5px 10px; font-size: 12px; margin-left: 5px;"
                                onclick="alternarStatusProduto(${prod.id}, ${prod.ativo})">
                            ${prod.ativo ? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play"></i>'}
                        </button>
                    </td>
                </tr>
            `;
            tabela.innerHTML += row;
        });
        
        document.getElementById('contador-produtos').textContent = produtosDemo.length;
        document.getElementById('produtos-ativos').textContent = 
            produtosDemo.filter(p => p.ativo).length;
    }
    
    // ==================== SE√á√ÉO PEDIDOS ====================
    
    async function carregarPedidosDoBanco() {
        try {
            const client = window.supabaseConfig?.getClient();
            const tabela = document.getElementById('tabela-todos-pedidos');
            
            if (!client || !tabela) {
                carregarPedidosDemo();
                return;
            }
            
            // Aplicar filtros
            const filtroStatus = document.getElementById('filtro-status').value;
            const filtroData = document.getElementById('filtro-data').value;
            
            let query = client.from('orders').select('*').order('created_at', { ascending: false });
            
            if (filtroStatus !== 'todos') {
                query = query.eq('status', filtroStatus);
            }
            
            if (filtroData) {
                const dataInicio = new Date(filtroData);
                const dataFim = new Date(dataInicio);
                dataFim.setDate(dataFim.getDate() + 1);
                
                query = query.gte('created_at', dataInicio.toISOString())
                           .lt('created_at', dataFim.toISOString());
            }
            
            const { data: pedidos, error } = await query;
            
            if (error) throw error;
            
            // Atualizar contador
            document.getElementById('total-pedidos').textContent = pedidos.length;
            
            // Atualizar tabela
            atualizarTabelaPedidosCompleta(pedidos);
            
        } catch (err) {
            console.error('Erro ao carregar pedidos:', err);
            carregarPedidosDemo();
        }
    }
    
    function carregarPedidosDemo() {
        const pedidosDemo = [
            { id: 2350, cliente_nome: 'Carlos Silva', total: 67.90, status: 'entregue', forma_pagamento: 'pix', created_at: new Date().toISOString() },
            { id: 2349, cliente_nome: 'Ana Santos', total: 89.50, status: 'em_entrega', forma_pagamento: 'cartao', created_at: new Date(Date.now() - 3600000).toISOString() },
            { id: 2348, cliente_nome: 'Jo√£o Oliveira', total: 45.90, status: 'preparando', forma_pagamento: 'dinheiro', created_at: new Date(Date.now() - 7200000).toISOString() },
            { id: 2347, cliente_nome: 'Maria Souza', total: 120.80, status: 'pendente', forma_pagamento: 'pix', created_at: new Date(Date.now() - 10800000).toISOString() },
            { id: 2346, cliente_nome: 'Pedro Costa', total: 67.90, status: 'entregue', forma_pagamento: 'cartao', created_at: new Date(Date.now() - 14400000).toISOString() }
        ];
        
        document.getElementById('total-pedidos').textContent = pedidosDemo.length;
        atualizarTabelaPedidosCompleta(pedidosDemo);
    }
    
    function atualizarTabelaPedidosCompleta(pedidos) {
        const tabela = document.getElementById('tabela-todos-pedidos');
        if (!tabela) return;
        
        tabela.innerHTML = '';
        
        if (pedidos.length === 0) {
            tabela.innerHTML = `
                <tr>
                    <td colspan="7" style="text-align: center; padding: 40px; color: #9CA3AF;">
                        <i class="fas fa-search" style="font-size: 24px; margin-bottom: 10px; display: block;"></i>
                        Nenhum pedido encontrado
                    </td>
                </tr>
            `;
            return;
        }
        
        pedidos.forEach(pedido => {
            const numero = pedido.id?.toString().slice(-4) || '0000';
            const data = new Date(pedido.created_at).toLocaleDateString('pt-BR');
            const hora = new Date(pedido.created_at).toLocaleTimeString('pt-BR', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            const statusCor = {
                'pendente': '#F59E0B',
                'aceito': '#3B82F6',
                'preparando': '#8B5CF6',
                'pronto': '#10B981',
                'em_entrega': '#EC4899',
                'entregue': '#6B7280',
                'cancelado': '#EF4444'
            }[pedido.status] || '#6B7280';
            
            const statusText = {
                'pendente': 'PENDENTE',
                'aceito': 'ACEITO',
                'preparando': 'PRODU√á√ÉO',
                'pronto': 'PRONTO',
                'em_entrega': 'ENTREGA',
                'entregue': 'ENTREGUE',
                'cancelado': 'CANCELADO'
            }[pedido.status] || pedido.status?.toUpperCase() || 'PENDENTE';
            
            const row = `
                <tr>
                    <td><strong>#${numero}</strong></td>
                    <td>${pedido.cliente_nome || 'Cliente'}</td>
                    <td>
                        <div>${data}</div>
                        <small style="color: #6B7280;">${hora}</small>
                    </td>
                    <td><strong>R$ ${parseFloat(pedido.total || 0).toFixed(2)}</strong></td>
                    <td>
                        <span style="background: #E5E7EB; color: #374151; padding: 4px 8px; border-radius: 4px; font-size: 12px;">
                            ${pedido.forma_pagamento?.toUpperCase() || 'N√ÉO INFORMADO'}
                        </span>
                    </td>
                    <td>
                        <span style="background: ${statusCor}20; color: ${statusCor}; 
                               padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;">
                            ${statusText}
                        </span>
                    </td>
                    <td>
                        <button class="btn-admin" style="padding: 5px 10px; font-size: 12px;"
                                onclick="verDetalhesPedido(${pedido.id || 0})">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn-admin btn-secondary" style="padding: 5px 10px; font-size: 12px; margin-left: 5px;"
                                onclick="editarPedido(${pedido.id || 0})">
                            <i class="fas fa-edit"></i>
                        </button>
                    </td>
                </tr>
            `;
            tabela.innerHTML += row;
        });
    }
    
    function filtrarPedidos() {
        carregarPedidosDoBanco();
    }
    
    function resetarFiltros() {
        document.getElementById('filtro-status').value = 'todos';
        document.getElementById('filtro-data').value = '';
        carregarPedidosDoBanco();
    }
    
    // ==================== SE√á√ÉO FINANCEIRO ====================
    
    async function atualizarDadosFinanceiros() {
        try {
            const client = window.supabaseConfig?.getClient();
            
            if (!client) {
                atualizarFinanceiroDemo();
                return;
            }
            
            // Buscar pedidos do m√™s atual
            const dataInicio = new Date();
            dataInicio.setDate(1);
            dataInicio.setHours(0, 0, 0, 0);
            
            const { data: pedidos, error } = await client
                .from('orders')
                .select('*')
                .gte('created_at', dataInicio.toISOString());
            
            if (error) throw error;
            
            // Calcular estat√≠sticas
            const faturamentoMensal = pedidos.reduce((total, pedido) => 
                total + (parseFloat(pedido.total) || 0), 0);
            
            const pedidosMes = pedidos.length;
            const ticketMedioGeral = pedidosMes > 0 ? (faturamentoMensal / pedidosMes) : 0;
            
            // Atualizar cards
            document.getElementById('faturamento-mensal').textContent = faturamentoMensal.toFixed(2);
            document.getElementById('pedidos-mes').textContent = pedidosMes;
            document.getElementById('ticket-medio-geral').textContent = ticketMedioGeral.toFixed(2);
            
            // Atualizar gr√°fico
            atualizarGraficoFinanceiro(pedidos);
            
        } catch (err) {
            console.error('Erro ao atualizar financeiro:', err);
            atualizarFinanceiroDemo();
        }
    }
    
    function atualizarFinanceiroDemo() {
        // Dados fict√≠cios
        const faturamento = 5240.80 + (Math.random() * 1000 - 500);
        const pedidos = 68 + Math.floor(Math.random() * 10 - 5);
        const ticket = faturamento / (pedidos || 1);
        
        document.getElementById('faturamento-mensal').textContent = faturamento.toFixed(2);
        document.getElementById('pedidos-mes').textContent = pedidos;
        document.getElementById('ticket-medio-geral').textContent = ticket.toFixed(2);
        
        // Gr√°fico demo
        atualizarGraficoFinanceiroDemo();
    }
    
    function atualizarGraficoFinanceiro(pedidos) {
        const grafico = document.getElementById('grafico-financeiro');
        if (!grafico) return;
        
        // Agrupar por dia dos √∫ltimos 7 dias
        const dias = [];
        const faturamentoPorDia = {};
        
        for (let i = 6; i >= 0; i--) {
            const data = new Date();
            data.setDate(data.getDate() - i);
            const diaStr = data.toLocaleDateString('pt-BR', { weekday: 'short' });
            dias.push(diaStr);
            faturamentoPorDia[diaStr] = 0;
        }
        
        pedidos.forEach(pedido => {
            const dataPedido = new Date(pedido.created_at);
            const hoje = new Date();
            const diferencaDias = Math.floor((hoje - dataPedido) / (1000 * 60 * 60 * 24));
            
            if (diferencaDias >= 0 && diferencaDias <= 6) {
                const diaStr = dataPedido.toLocaleDateString('pt-BR', { weekday: 'short' });
                faturamentoPorDia[diaStr] += parseFloat(pedido.total) || 0;
            }
        });
        
        // Gerar gr√°fico
        grafico.innerHTML = '';
        const valores = dias.map(dia => faturamentoPorDia[dia]);
        const maxValor = Math.max(...valores, 1);
        
        dias.forEach((dia, index) => {
            const valor = valores[index];
            const altura = (valor / maxValor) * 200;
            
            const barra = `
                <div style="text-align: center; flex: 1; padding: 0 5px;">
                    <div style="
                        background: linear-gradient(to top, var(--roxo-admin), var(--magenta)); 
                        height: ${Math.max(altura, 10)}px; 
                        border-radius: 5px 5px 0 0;
                        transition: height 0.5s ease;
                    "></div>
                    <p style="margin: 10px 0 0; font-weight: 600; font-size: 12px;">${dia}</p>
                    <p style="color: #6B7280; font-size: 11px;">R$ ${valor.toFixed(0)}</p>
                </div>
            `;
            grafico.innerHTML += barra;
        });
    }
    
    function atualizarGraficoFinanceiroDemo() {
        const grafico = document.getElementById('grafico-financeiro');
        if (!grafico) return;
        
        const dias = ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b', 'Dom'];
        const valores = dias.map(() => Math.random() * 1000 + 500);
        const maxValor = Math.max(...valores);
        
        grafico.innerHTML = '';
        
        dias.forEach((dia, index) => {
            const valor = valores[index];
            const altura = (valor / maxValor) * 200;
            
            const barra = `
                <div style="text-align: center; flex: 1; padding: 0 5px;">
                    <div style="
                        background: linear-gradient(to top, var(--roxo-admin), var(--magenta)); 
                        height: ${Math.max(altura, 10)}px; 
                        border-radius: 5px 5px 0 0;
                    "></div>
                    <p style="margin: 10px 0 0; font-weight: 600; font-size: 12px;">${dia}</p>
                    <p style="color: #6B7280; font-size: 11px;">R$ ${valor.toFixed(0)}</p>
                </div>
            `;
            grafico.innerHTML += barra;
        });
    }
    
    function gerarRelatorio() {
        const data = document.getElementById('data-relatorio').value;
        if (!data) {
            mostrarNotificacao('Selecione uma data', 'warning');
            return;
        }
        
        mostrarNotificacao(`Gerando relat√≥rio para ${data}...`, 'info');
        
        // Simular gera√ß√£o de relat√≥rio
        setTimeout(() => {
            const tabela = document.getElementById('tabela-relatorio');
            tabela.innerHTML = `
                <tr>
                    <td>08:00-10:00</td>
                    <td>3</td>
                    <td>R$ 145,50</td>
                    <td>R$ 48,50</td>
                    <td><span style="color: #10B981">‚óè</span></td>
                </tr>
                <tr>
                    <td>10:00-12:00</td>
                    <td>5</td>
                    <td>R$ 289,90</td>
                    <td>R$ 57,98</td>
                    <td><span style="color: #10B981">‚óè</span></td>
                </tr>
                <tr>
                    <td>12:00-14:00</td>
                    <td>8</td>
                    <td>R$ 512,40</td>
                    <td>R$ 64,05</td>
                    <td><span style="color: #F59E0B">‚óè</span></td>
                </tr>
                <tr>
                    <td>14:00-16:00</td>
                    <td>4</td>
                    <td>R$ 198,80</td>
                    <td>R$ 49,70</td>
                    <td><span style="color: #10B981">‚óè</span></td>
                </tr>
                <tr>
                    <td>16:00-18:00</td>
                    <td>7</td>
                    <td>R$ 423,50</td>
                    <td>R$ 60,50</td>
                    <td><span style="color: #10B981">‚óè</span></td>
                </tr>
                <tr style="background: #F9FAFB; font-weight: bold;">
                    <td>TOTAL</td>
                    <td>27</td>
                    <td>R$ 1.570,10</td>
                    <td>R$ 58,15</td>
                    <td>M√âDIA</td>
                </tr>
            `;
            
            mostrarNotificacao('Relat√≥rio gerado com sucesso!', 'success');
        }, 1500);
    }
    
    function exportarDados() {
        mostrarNotificacao('Exportando dados...', 'info');
        // Aqui implementaria exporta√ß√£o real
        setTimeout(() => {
            mostrarNotificacao('Dados exportados com sucesso!', 'success');
        }, 2000);
    }
    
    // ==================== FUN√á√ïES AUXILIARES ====================
    
    function forcarAtualizacao() {
        const secaoAtiva = document.querySelector('.section.active').id;
        
        switch(secaoAtiva) {
            case 'dashboard':
                atualizarDashboard();
                break;
            case 'produtos':
                carregarProdutosDoBanco();
                break;
            case 'pedidos':
                carregarPedidosDoBanco();
                break;
            case 'financeiro':
                atualizarDadosFinanceiros();
                break;
        }
        
        mostrarNotificacao('Atualiza√ß√£o for√ßada realizada!', 'success');
    }
    
    function atualizarDataHora() {
        const agora = new Date();
        const data = agora.toLocaleDateString('pt-BR', { 
            weekday: 'long', 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric'
        });
        
        const hora = agora.toLocaleTimeString('pt-BR', { 
            hour: '2-digit', 
            minute: '2-digit'
        });
        
        const dataAtual = document.querySelector('#data-atual');
        if (dataAtual) {
            dataAtual.textContent = `${data} ‚Ä¢ ${hora}`;
        }
    }
    
    function verificarConexao() {
        const client = window.supabaseConfig?.getClient();
        const status = document.getElementById('status-conexao');
        
        if (client) {
            status.innerHTML = '‚úÖ Conectado ao banco';
            status.style.color = '#10B981';
        } else {
            status.innerHTML = '‚ö†Ô∏è Modo demonstra√ß√£o';
            status.style.color = '#F59E0B';
        }
    }
    
    function atualizarStatusConexao() {
        setInterval(verificarConexao, 10000);
    }
    
    function pararTodasAtualizacoes() {
        Object.values(intervalosAtualizacao).forEach(intervalo => {
            if (intervalo) clearInterval(intervalo);
        });
    }
    
    function mudarIntervaloAtualizacao() {
        const select = document.getElementById('intervalo-atualizacao');
        intervaloGlobal = parseInt(select.value);
        
        // Atualizar display
        const display = document.querySelector('.admin-header .f3F4F6 div:nth-child(2)');
        if (display) {
            display.textContent = `${intervaloGlobal/1000} seg`;
        }
        
        // Reiniciar atualiza√ß√£o da se√ß√£o atual
        const secaoAtiva = document.querySelector('.section.active').id;
        mostrarSecao(secaoAtiva);
        
        mostrarNotificacao(`Intervalo alterado para ${intervaloGlobal/1000} segundos`, 'success');
    }
    
    function salvarConfiguracoes() {
        const nomeLoja = document.getElementById('nome-loja').value;
        const whatsapp = document.getElementById('whatsapp-loja').value;
        const horario = document.getElementById('horario-loja').value;
        
        // Aqui salvaria no banco
        localStorage.setItem('georgia_config', JSON.stringify({
            nomeLoja, whatsapp, horario
        }));
        
        mostrarNotificacao('Configura√ß√µes salvas com sucesso!', 'success');
    }
    
    // Modal Produto
    function abrirModalProduto() {
        document.getElementById('modal-produto').style.display = 'flex';
    }
    
    function fecharModalProduto() {
        document.getElementById('modal-produto').style.display = 'none';
        // Limpar campos
        document.getElementById('produto-nome').value = '';
        document.getElementById('produto-descricao').value = '';
        document.getElementById('produto-preco').value = '29.90';
        document.getElementById('produto-categoria').value = '';
    }
    
    async function salvarProduto() {
        const nome = document.getElementById('produto-nome').value;
        const descricao = document.getElementById('produto-descricao').value;
        const preco = document.getElementById('produto-preco').value;
        const categoria = document.getElementById('produto-categoria').value;
        
        if (!nome || !preco || !categoria) {
            mostrarNotificacao('Preencha todos os campos obrigat√≥rios!', 'error');
            return;
        }
        
        try {
            const client = window.supabaseConfig?.getClient();
            
            if (client) {
                const { error } = await client
                    .from('products')
                    .insert([{
                        nome: nome,
                        descricao: descricao,
                        preco: parseFloat(preco),
                        categoria: categoria,
                        ativo: true,
                        imagem_url: 'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=400&h=300&fit=crop'
                    }]);
                
                if (error) throw error;
            }
            
            mostrarNotificacao(`Produto "${nome}" salvo com sucesso!`, 'success');
            fecharModalProduto();
            
            // Atualizar lista se estiver na se√ß√£o de produtos
            if (document.getElementById('produtos').classList.contains('active')) {
                carregarProdutosDoBanco();
            }
            
        } catch (err) {
            console.error('Erro ao salvar produto:', err);
            mostrarNotificacao('Erro ao salvar produto', 'error');
        }
    }
    
    // Fun√ß√µes placeholder
    function editarProduto(id) {
        mostrarNotificacao(`Editando produto ${id}...`, 'info');
        // Implementar edi√ß√£o real
    }
    
    async function alternarStatusProduto(id, atual) {
        const novoStatus = !atual;
        
        try {
            const client = window.supabaseConfig?.getClient();
            
            if (client) {
                const { error } = await client
                    .from('products')
                    .update({ ativo: novoStatus })
                    .eq('id', id);
                
                if (error) throw error;
            }
            
            mostrarNotificacao(`Produto ${novoStatus ? 'ativado' : 'pausado'}!`, 'success');
            
            // Atualizar lista
            if (document.getElementById('produtos').classList.contains('active')) {
                carregarProdutosDoBanco();
            }
            
        } catch (err) {
            console.error('Erro ao alterar status:', err);
            mostrarNotificacao('Erro ao alterar status', 'error');
        }
    }
    
    function verDetalhesPedido(id) {
        mostrarNotificacao(`Abrindo detalhes do pedido #${id}...`, 'info');
        // Implementar detalhes do pedido
    }
    
    function editarPedido(id) {
        mostrarNotificacao(`Editando pedido #${id}...`, 'info');
        // Implementar edi√ß√£o de pedido
    }
    
    // Sistema de notifica√ß√µes
    function mostrarNotificacao(mensagem, tipo = 'info') {
        const cores = {
            'success': '#10B981',
            'error': '#EF4444',
            'info': '#3B82F6',
            'warning': '#F59E0B'
        };
        
        const icones = {
            'success': 'fa-check-circle',
            'error': 'fa-exclamation-circle',
            'info': 'fa-info-circle',
            'warning': 'fa-exclamation-triangle'
        };
        
        // Remover notifica√ß√µes antigas
        document.querySelectorAll('.notificacao-admin').forEach(el => el.remove());
        
        const notificacao = document.createElement('div');
        notificacao.className = 'notificacao-admin';
        notificacao.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: ${cores[tipo] || '#3B82F6'};
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 10000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 400px;
        `;
        
        notificacao.innerHTML = `
            <i class="fas ${icones[tipo] || 'fa-info-circle'}"></i>
            <span>${mensagem}</span>
        `;
        
        document.body.appendChild(notificacao);
        
        // Remover ap√≥s 5 segundos
        setTimeout(() => {
            notificacao.style.animation = 'slideOut 0.3s ease';
            setTimeout(() => notificacao.remove(), 300);
        }, 5000);
        
        // Adicionar anima√ß√µes CSS se n√£o existirem
        if (!document.querySelector('#animacoes-notificacoes-admin')) {
            const style = document.createElement('style');
            style.id = 'animacoes-notificacoes-admin';
            style.textContent = `
                @keyframes slideIn {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
                
                @keyframes slideOut {
                    from {
                        transform: translateX(0);
                        opacity: 1;
                    }
                    to {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
        }
    }
    
    // Inicializar notifica√ß√µes do sistema
    if (window.supabaseConfig) {
        window.supabaseConfig.mostrarNotificacao = mostrarNotificacao;
    }
    </script>
</body>
</html>
